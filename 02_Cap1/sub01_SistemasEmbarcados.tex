\section{\textbf{Sistemas Embarcados}}
\label{sec:SistemasEmbarcados}
\subsection{\textbf{Conceitos Preliminares}}
\label{subsec:sub01_Conceitos}

\subsection{\textbf{Definição de Sistemas Embarcados}}
\label{subsec:sub01_Definicao}
Um sistema embarcado pode ser definido, como um sistema computacional, interno a um dispositivo eletrônico, que executa, repetitivamente, uma única função, ou um pequeno conjunto de funções, de maneira que, frequentemente, a forma que estas tarefas são executadas não é percebida pelo seu usuário, assim como expõe \citeonline[p.~1]{Chatto2013}, mas sim os resultados da realização das mesmas. Já o termo “sistema embarcado” deriva do fato que estes sistemas são totalmente integrados e enclausurados pelos sistemas a que servem ou controlam, dessa forma, com este enclausuramento, tem-se como consequência que estes sistemas se tornam especializados em realizar tarefas específicas à operação do dispositivo que o contém, \cite[p.~554]{Springer2009}. Essa especialização é notada no software embarcado, também chamado de firmware, que se torna específico ao hardware utilizado, e o próprio hardware, que tem características que o diferem de um hardware de sistema de propósito geral. 

Com o objetivo de deixar mais claro o que essa falta de generalidade relacionada a funcionalidade de um sistema embarcado implica, \citeonline[p.~2]{Steve2003} complementa ao dizer que tais sistemas não são construídos de forma a serem programados pelo usuário final, não da forma que um sistema genérico possibilita, pois, o usuário final de um sistema embarcado não pode alterar a funcionalidade do sistema, seja adicionando, ou mesmo retirando, software. Observe, por exemplo, que um computador pessoal, um exemplo de sistema de propósito geral, pode funcionar como um processador de texto e, em um instante, começar a funcionar como um navegador web, observe ainda que, é permitido, ao usuário, adicionar diversas funcionalidades ao sistema, sem que o sistema tenha vindo configurado para execução da nova funcionalidade de fábrica. 

\subsection{\textbf{Características}}
\label{subsec:sub01_Caracteristicas}
Algumas características dos sistemas embarcados serão descritas a seguir, que é uma breve explanação sobre alguns pontos apresentados por \citeonline[p.~2-4]{Chatto2013}, importante notar que a exibição de todas estas características descritas não é obrigatória, porém, são muito comuns e importantes nestes sistemas, e, geralmente, alguma delas se sobressai, dependendo da finalidade do sistema em questão.

 A interação com o ambiente é uma característica presente na maioria dos sistemas embarcados, esta é feita por meio de sensores, que coletam dados do ambiente, e, ou, de atuadores, que atuam em alguns parâmetros do ambiente. Através da interação com o ambiente, os sistemas embarcados podem ser sistemas reativos, ou seja, possuir interação contínua e reagir a eventos do ambiente, onde o sistema pode, por exemplo, apresentar estados que transitam em resposta à ocorrência de eventos, ou reagir, com o objetivo de controlar algum tipo de variável do ambiente. Pode-se citar ainda, como uma característica, a mistura de componentes digitais e analógicos, que é inerente a interação com o ambiente. O ambiente, cuja natureza é predominantemente contínua. Portanto, frequentemente, a natureza digital dos computadores se mescla com a natureza analógica do ambiente para a implementação de um sistema embarcado.
 
A interface com o usuário, comumente, é mais simples que a encontrada em sistemas mais genéricos, composta por componentes que geralmente causam a ilusão ao usuário de falta de computação, como LEDs e botões.

A limitação do sistema, este que é restringido de diversos ângulos. Nota-se que, um sistema embarcado, pela sua própria natureza limitada, possui limitações de performance e de consumo de energia, que influenciam na escolha do dispositivo alvo. Como exemplo, o volume físico é uma limitação de projeto muito comum, dentre tantas outras limitações específicas de cada projeto, com sua relevância intrínseca ao projeto, como robustez a variação de temperatura, resistência a radiação, ou vibração mecânica. De fato, nenhum sistema é de todo livre de restrições, porém, nos sistemas embarcados, essas restrições são muito mais evidentes e são, em certos casos, consequência de requisitos do sistema.

A confiabilidade do sistema, já que, como um sistema embarcado tem a capacidade de funcionar autonomamente, estes são empregados em diversas atividades de natureza crítica, o que exige, frequentemente, disponibilidade e manutenibilidade do sistema e também segurança da informação processada pelo sistema. 

Relacionado à confiabilidade, está também a característica de processamento em tempo real, que se refere a exigência de resposta em um tempo fixo e finito de tempo de uma requisição. O não cumprimento desta exigência pode levar a consequências catastróficas em sistemas de tempo real. 

\subsection{\textbf{Elementos de um Sistema Embarcado}}
\label{subsec:sub01_Elementos}
Um sistema embarcado, geralmente, é um sistema microprocessado, isto significa que o mesmo, geralmente, se utiliza de uma unidade central para o processamento, o processador. Este processador pode ser implementado através de dispositivos de hardware programável, como um FPGA, ou se utilizar de um processador dedicado disponível no mercado, ou ainda, caso não se utilize um processador formal, um sistema embarcado poderia ser ainda implementado com a utilização de circuitos lógicos digitais, sem perca de sua condição de sistema embarcado. Porém, essas abordagens são geralmente mais complexas, e exigem um tempo de implementação maior do que o gasto quando um dispositivo com um processador pronto, que atende os requisitos do projeto, está disponível. Com esta visão, os microcontroladores aparentam ser grandes aliados dos sistemas embarcados.

\paragraph{\textbf{Microcontrolador -}}
Um microcontrolador, segundo \citeonline{Steve2003}, é um dispositivo que é autocontido e possui processador, memória e periféricos em um mesmo chip, o que, para projetistas de sistemas embarcados é de grande ajuda, já que a utilização destes elementos no sistema é feita através de software, poupando o projetista de futuros e eventuais complicações de interface e de compatibilidade. Caso se utilizasse um microprocessador ao invés de um microcontrolador, elementos externos deveriam ser adicionados para prover as funcionalidades fornecidas pelos periféricos e memória, porém, quando baseados em processadores dedicados, geralmente, os sistemas possuem maior performance computacional, em relação a sistemas baseados em microcontrolador, isto é devido ao hardware dedicado e otimizado para processamento, logo, o projetista deverá analisar se o esforço de implementação compensará o ganho computacional ao decidir a abordagem que deve seguir.
Na escolha de um microcontrolador, destacam-se alguns fatores importantes, \cite[p.8]{Chatto2013}, apresentados a seguir: 
\begin{itemize}
    \item Velocidade do microcontrolador:
    deve ser suficiente para o processamento requerido.
    \item Tamanho e encapsulamento do chip:
    pode interferir no tamanho do dispositivo final. 
    \item Espaço de memória:
    deve ser suficiente para armazenar a memória do sistema.
    \item Custo unitário do chip:
    não deve ser proibitivo para o custo do sistema.
    \item Recursos da plataforma de desenvolvimento:
    recursos podem ajudar no desenvolvimento do sistema, como por exemplo o recurso de debugging.
    \item Disponibilidade do chip no mercado:
    em um produto comercial pode implicar em maiores custos para manutenção e custos de produção.
\end{itemize}

Pode-se citar também como fator importante na escolha de um microcontrolador, a questão dos periféricos encontrados no chip, estes devem englobar os periféricos necessários para a implementação do sistema, ou, pelo menos que os periféricos faltantes possam ter sua funcionalidade implementada de uma outra maneira.

\paragraph{\textbf{Periféricos do Microcontrolador -}}
Um sistema embarcado, com sua característica de comunicação com o mundo exterior, necessita de periféricos. Os periféricos internos ao chip do microcontrolador são recursos implementados em hardware que podem ser utilizados por meio do software dentro do microcontrolador. Por exemplo, existem periféricos relacionados a comunicação, levantamento de interrupções (possibilitando tratamento de eventos esporádicos no sistema), temporização, contagem de eventos, leitura de dados analógicos, modulação de largura de pulso (possibilitando a geração de um sinal analógico), dentre outros periféricos mais específicos, internos ao chip do microcontrolador, evitando a implementação destes em hardware ou software. Periféricos podem ser adicionados a um sistema embarcado sem que sejam internos ao microcontrolador, a seguir, a fim de descrever alguns dos periféricos internos ao microntrolador, segue-se algumas informações sobre alguns deles.
\begin{itemize}
    \item Conversor analógico digital:
    Este periférico, tem a funcionalidade de interpretar valores analógicos de tensão e então convertê-los para valores digitais, assim, o processador poderá utilizar o dado medido para a aplicação no sistema. Com o grande número de sensores existentes, diversas grandezas, como temperatura ou pressão, podem ser convertidas para sinais de tensão e serem utilizadas pelo sistema por meio da utilização deste periférico.
    \item Timer:
    Um temporizador em hardware, de forma que seu funcionamento é independentemente da execução do software, o que permite maior robustez na medição de tempo. Um timer possui um tamanho máximo de contagem, e possui também registradores que armazenam o valor atual desta contagem. Quando o valor máximo de contagem for estourado, o timer pode gerar uma interrupção, produzindo uma rotina de tratamento de interrupção de estouro de timer. Uma aplicação de uso de um timer poderia ser a execução de rotinas periódicas. 
    \item Comunicação (USART, MSSP):
    A comunicação é importante pois permite a utilização de mais elementos no sistema atuando em conjunto, de fato, diversos elementos, como sensores, memórias ou displays se utilizam de uma interface de comunicação.  Quanto aos periféricos relacionados, eles existem para diferentes interfaces de comunicação, como SPI, I2C e RS232, por exemplo, que serão descritas mais adiante no texto. Para fim de exemplificação, em alguns microcontroladores PIC, existe um módulo de comunicação serial síncrona que suporta SPI e I2C (módulo MSSP) e um módulo de comunicação serial assíncrona que suporta RS-232 e RS-485 (módulo USART), \cite{pic18:DS39500A}. 
    \item PWM/Capture/Compare:
    Este periférico agrupa três possíveis funcionalidades do módulo, que são associadas a módulos de timer e um pino específico do microcontrolador. Em modo Compare, um valor determinado, escrito nos registradores deste módulo, é constantemente comparado com o valor de contagem do timer associado, quando o valor é atingido, ou seja, um tempo determinado se passa, o pino altera de nível lógico ou vai para um nível lógico definido, assim pode-se utilizar este recurso para a geração de um sinal. No modo Capture, algo parecido com o inverso do modo Compare é feito, neste modo, quando uma alteração no estado do pino associado ocorre, o valor da contagem do timer é capturado, assim, se pode medir o tempo entre os eventos no pino. Já o modo PWM permite que um sinal periódico possa ser gerado, através do pino associado, com tempos em nível alto e baixo que respeitam o ciclo de trabalho definido, ou duty cycle, este parâmetro define o tempo que o sinal passará em alto com relação ao período do sinal periódico, assim, por exemplo, um duty cycle de 30\% indica que o sinal passará 30\% do período em nível alto. O PWM é uma sigla que vem de Pulse Width Modulation, ou seja, modulação de largura de pulso, pois gera um trem de pulsos com largura controlada, este periférico pode ser usado como sinal para comandar motores de corrente contínua por exemplo.\cite{pic18:DS39500A}. 
\end{itemize}

Além destes periféricos, um periférico interessante é o de interrupção externa, este possibilita o levantamento de uma interrupção no sistema, que, por sua vez, leva a execução de uma rotina de interrupção. A interrupção, para este periférico, é levantada quando uma mudança de estado de um pino específico acontece, assim, através desta funcionalidade, diversos eventos podem executar uma rotina de tratamento. Interessante dizer que essa interrupção pode ser gerada a qualquer momento, desde que esteja habilitada, bastando para isso que o evento em questão altere o estado do pino específico do microcontrolador.